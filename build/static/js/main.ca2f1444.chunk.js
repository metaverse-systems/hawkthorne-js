(this["webpackJsonphawkthorne-js"]=this["webpackJsonphawkthorne-js"]||[]).push([[0],{18:function(t){t.exports=JSON.parse('["abed-castle-interior","abed-cave","acschool","admin-hallway","baseball","black-caverns-2","black-caverns-3","black-caverns","blacksmith","blacksmith-upstairs","borchert-hallway","castle-hawkthorne-entrance","castle-hawkthorne-room-1","castle-hawkthorne-room-2","castle-hawkthorne-room-3","castle-hawkthorne-room-4","castle-hawkthorne-throne","castle-hawkthorne","class-basement","class-hallway-2","class-hallway","deans-closet2","deans-closet","deans-office-2","deans-office","dorm-lobby","forest-2","forest-hidden","forest","frozencave-2","frozencave-3","frozencave","gay-island-2","gay-island-3","gay-island-4","gay-island","gazette-office-2","gazette-office","greendale-anthropology","greendale-biology","greendale-englishmemorial","greendale-exterior","greendale-fry","greendale-ladders","greendale-quad","hallway","house","lab","mens-bathroom","new-abedtown","parking-lot","potteryclass","rainbow-bar","rave-hallway","seabluff","secretwritersgarden","sophieb","studyroom","sunchamber","tavern","test-level","town","trampoline","treeline","upstairs","valley-2","valley-3","valley-chili-fields-2","valley-chili-fields","valley-goat-cave","valley-goat-farm","valley-hills-2","valley-hills","valley-sandpits-2","valley-sandpits-entrance","valley-sandpits","valley-tacotown","valley","vents-2","vents","village-forest-2","village-forest-3","village-forest-4","village-forest-acornpeak-2","village-forest-acornpeak","village-forest-mines-2","village-forest-mines-3","village-forest-mines-entrance","village-forest-mines-return","village-forest-mines-room","village-forest-mines-storage-room","village-forest-mines","village-forest-stonerspeak-2","village-forest-stonerspeak-return","village-forest-stonerspeak","village-forest","village-treeline","winterwonderland2","winterwonderland","womens-bathroom"]')},23:function(t,e,n){},24:function(t,e,n){},38:function(t,e,n){"use strict";n.r(e);var o=n(6),a=n.n(o),i=n(15),r=n.n(i),s=(n(23),n(1)),c=n(16),l=n(4),h=n(3),p=(n(24),n(17)),d=n.n(p),u=n(2),m=n(7),f=function t(e,n,o,a){var i=this;Object(s.a)(this,t),this.draw=function(t,e,n,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};void 0===a.scale&&(a.scale=1);var r=1,s=0,c=1,l=0,h=n,p=o;if(!0===a.flipHorizontal&&(r=-1,s=i.canvas.width,h=i.canvas.width-n-i.spriteWidth),!0===a.flipVertical&&(c=-1,l=i.canvas.height,p=i.canvas.height-o-i.spriteHeight),a.flipDiagonal)return i.context.save(),i.context.translate(n,o),i.context.rotate(Math.PI/180*270),i.context.drawImage(i.sheet,t*i.spriteWidth,e*i.spriteHeight,i.spriteWidth,i.spriteHeight,-i.spriteWidth,0,i.spriteWidth*a.scale,i.spriteHeight*a.scale),void i.context.restore();a.flipVertical||a.flipHorizontal?(i.context.save(),i.context.translate(s,l),i.context.scale(r,c),i.context.drawImage(i.sheet,t*i.spriteWidth,e*i.spriteHeight,i.spriteWidth,i.spriteHeight,h,p,i.spriteWidth*a.scale,i.spriteHeight*a.scale),i.context.restore()):i.context.drawImage(i.sheet,t*i.spriteWidth,e*i.spriteHeight,i.spriteWidth,i.spriteHeight,n,o,i.spriteWidth*a.scale,i.spriteHeight*a.scale)},this.sheet=new Image,this.sheet.src=n,this.spriteWidth=o,this.spriteHeight=a,this.canvas=e,this.context=e.getContext("2d")},b=function t(e,n,o,a,i){var r=this;Object(s.a)(this,t),this.animate=function(t,e,n,o,a){var i=!1;if(r.animation!==t&&(r.animation=t,i=!0),r.direction!==e&&(r.direction=e,i=!0),i){r.frame=0,r.loop=[];var s=r.characterMap[t],c=[];Array.isArray(s)?(r.repeat=s[0],c=s[1]):(r.repeat=s[e][0],c=s[e][1]),c.forEach((function(t){var e=t.split(","),n=Object(m.a)(e,2),o=n[0],a=n[1];if(-1!==o.search("-"))for(var i=o.split("-"),s=Object(m.a)(i,2),c=s[0],l=s[1],h=c;h<=l;h++)r.loop.push({x:h-1,y:a-1});else r.loop.push({x:o-1,y:a-1})}))}r.draw(n,o,a)},this.draw=function(t,e,n){0!==r.loop.length&&(r.sheet.draw(r.loop[r.frame].x,r.loop[r.frame].y,t,e,n),r.frame++,r.frame===r.loop.length&&(r.frame=0))},this.sheet=new f(e,n,o,a),this.frame=0,this.animation="",this.direction="",this.repeat="",this.loop=[],this.characterMap=i},g=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var o;return Object(s.a)(this,n),(o=e.call(this,t)).sprite=new b(t.canvas,t.url,t.width,t.height,t.characterMap),o.Type="SpriteComponent",o}return n}(u.Component),v=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var o;return Object(s.a)(this,n),(o=e.call(this,t)).sprite=new f(t.canvas,t.url,t.width,t.height),o.Type="StaticSpriteComponent",o}return n}(u.Component),y=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var o;return Object(s.a)(this,n),(o=e.call(this,t)).Type="TilesheetComponent",o}return n}(u.Component),w=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var o;return Object(s.a)(this,n),(o=e.call(this,t)).tilesheet=t.tilesheet,o.width=t.width,o.height=t.height,o.x=t.x,o.y=t.y,o.options=t.options,o.Type="TileComponent",o}return n}(u.Component),C=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var o;return Object(s.a)(this,n),(o=e.call(this,t)).x=t.x,o.y=t.y,o.Type="PositionComponent",o}return n}(u.Component),j=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var o;return Object(s.a)(this,n),(o=e.call(this,t)).points=t.points,o.Type="PolygonComponent",o}return n}(u.Component),x=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var o;return Object(s.a)(this,n),void 0===t&&(t={}),(o=e.call(this,t)).Init=function(){o.Container.Components.TilesheetComponent={},o.Container.Components.TileComponent={},o.Container.Components.PositionComponent={},o.Container.Components.SpriteComponent={},o.Container.Components.StaticSpriteComponent={},o.Container.Components.PolygonComponent={}},o.ConfigUpdate=function(t){Object.keys(t).forEach((function(e){o.config[e]=t[e]}))},o.Update=function(){if(void 0!==o.config.board){var t=o.config.board.getContext("2d");t.clearRect(0,0,o.config.board.width,o.config.board.height),void 0!==o.Container.Components.TilesheetComponent&&Object.keys(o.Container.Components.TilesheetComponent).forEach((function(t){var e=o.Container.Components.TilesheetComponent[t];void 0===o.tilesheets[e.url]&&(o.tilesheets[e.url]=new f(o.config.board,e.url,e.width,e.height),o.Container.Entity(t).destroy())})),void 0!==o.Container.Components.TileComponent&&Object.keys(o.Container.Components.TileComponent).forEach((function(t){var e=o.Container.Components.TileComponent[t],n=o.Container.Components.PositionComponent[t];o.tilesheets[e.tilesheet].draw(e.x,e.y,n.x*e.width,n.y*e.height,e.options)})),void 0!==o.Container.Components.StaticSpriteComponent&&Object.keys(o.Container.Components.StaticSpriteComponent).forEach((function(t){var e=o.Container.Components.StaticSpriteComponent[t],n=o.Container.Components.PositionComponent[t];e.sprite&&e.sprite.draw(0,0,n.x,n.y,e.options)})),void 0!==o.Container.Components.SpriteComponent&&Object.keys(o.Container.Components.SpriteComponent).forEach((function(t){var e=o.Container.Components.SpriteComponent[t],n=o.Container.Components.PositionComponent[t];e.sprite&&e.sprite.animate(e.animation,e.direction,n.x,n.y,{})})),void 0!==o.Container.Components.PolygonComponent&&Object.keys(o.Container.Components.PolygonComponent).forEach((function(e){var n=o.Container.Components.PolygonComponent[e],a=o.Container.Components.PositionComponent[e],i=n.points[0];t.strokeStyle="#f00",t.beginPath(),t.moveTo(i.x+a.x,i.y+a.y),n.points.forEach((function(e){t.lineTo(e.x+a.x,e.y+a.y)})),t.closePath(),t.stroke()}))}},o.Handle="DrawingSystem",o.tilesheets={},o}return n}(u.System),O=n(28),k=function t(e){Object(s.a)(this,t);for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n].name,a=e.attributes[n].textContent;this[o]=a}this.objects=[];for(var i=0;i<e.childNodes.length;i++){var r=e.childNodes[i].nodeName;switch(r){case"object":this.objects.push(new S(e.childNodes[i]));break;case"#text":break;default:console.log("ObjectGroup: Unknown node "+r)}}},S=function t(e){Object(s.a)(this,t);for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n].name,a=e.attributes[n].textContent;this[o]=a}for(var i=0;i<e.childNodes.length;i++){var r=e.childNodes[i].nodeName;switch(r){case"polygon":this.polygon=new E(e.childNodes[i]);break;case"properties":this.properties=new T(e.childNodes[i]);break;case"#text":break;default:console.log("TMX_Object: Unknown node "+r)}}},E=function t(e){var n=this;Object(s.a)(this,t),this.points=[];for(var o={},a=0;a<e.attributes.length;a++){var i=e.attributes[a].name,r=e.attributes[a].textContent;o[i]=r}void 0!==o.points&&o.points.split(" ").forEach((function(t){var e=t.split(","),o=Object(m.a)(e,2),a=o[0],i=o[1];n.points.push({x:a-0,y:i-0})}))},N=function t(e){Object(s.a)(this,t);for(var n=0;n<e.childNodes.length;n++){var o=e.childNodes[n].nodeName;switch(o){case"property":for(var a=e.childNodes[n].attributes,i=0;i<a.length;i++){var r=a[i].name,c=a[i].textContent;this[r]=c}break;case"#text":break;default:console.log("Unknown node "+o)}}},T=function t(e){Object(s.a)(this,t);for(var n=0;n<e.childNodes.length;n++){var o=e.childNodes[n].nodeName;switch(o){case"property":for(var a=e.childNodes[n].attributes,i="",r="",c=0;c<a.length;c++)"name"===a[c].name&&(i=a[c].textContent),"value"===a[c].name&&(r=a[c].textContent);this[i]=r;break;case"#text":break;default:console.log("Unknown node "+o)}}},M=function t(e){Object(s.a)(this,t);for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n].name,a=e.attributes[n].textContent;this[o]=a}for(var i=0;i<e.childNodes.length;i++){var r=e.childNodes[i].nodeName;switch(r){case"properties":this.properties=new N(e.childNodes[i]);break;case"image":this.image=new z(e.childNodes[i]);break;case"#text":break;default:console.log("Tileset: Unknown node "+r)}}},P=function t(e){Object(s.a)(this,t);for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n].name,a=e.attributes[n].textContent;this[o]=a}for(var i=0;i<e.childNodes.length;i++){var r=e.childNodes[i].nodeName;switch(r){case"#text":break;case"data":this.tiles=new H(e.childNodes[i]).tiles;break;case"properties":this.properties=new N(e.childNodes[i]);break;default:console.log("Layer: Unknown node "+r)}}},H=function t(e){Object(s.a)(this,t);for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n].name,a=e.attributes[n].textContent;this[o]=a}var i=atob(e.innerHTML),r=O.inflate(i);this.tiles=[];for(var c=0;c<r.length;c+=4){var l=(r[c+3]<<24)+(r[c+2]<<16)+(r[c+1]<<8)+r[c+0],h={};2147483648&l&&(h.flipHorizontal=!0,l^=2147483648),1073741824&l&&(h.flipVertical=!0,l^=1073741824),536870912&l&&(h.flipDiagonal=!0,l^=536870912),h.id=l-1,this.tiles.push(h)}},z=function t(e){Object(s.a)(this,t);for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n].name,a=e.attributes[n].textContent;this[o]=a}},I=function t(e){var n=this;Object(s.a)(this,t),fetch(e).then((function(t){return t.text()})).then((function(t){for(var e=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("map")[0],o=0;o<e.attributes.length;o++){var a=e.attributes[o].name,i=e.attributes[o].textContent;"version"!==a&&(n[a]=i)}n.tilesets=[],n.layers=[],n.objectgroups=[];for(var r=0;r<e.childNodes.length;r++){var s=e.childNodes[r].nodeName;switch(s){case"properties":n.properties=new T(e.childNodes[r]);break;case"tileset":n.tilesets.push(new M(e.childNodes[r]));break;case"layer":n.layers.push(new P(e.childNodes[r]));break;case"objectgroup":n.objectgroups.push(new k(e.childNodes[r]));break;case"#text":break;default:console.log("Unknown node "+s)}}}))},W=n(18),D=n(0),U=new u.Manager,B="https://raw.githubusercontent.com/hawkthorne/hawkthorne-journey/master",V=B+"/src/images/characters/",F=["abed","britta","chang","duncan","garrett","guzman","leonard","rich","troy","vicedean","annie","buddy","dean","fatneil","gilbert","jeff","pierce","shirley","vaughn","vicki"],L=function(t){Object(l.a)(n,t);var e=Object(h.a)(n);function n(t){var o;return Object(s.a)(this,n),(o=e.call(this,t)).componentDidMount=function(){o.handleResize(),fetch("https://raw.githubusercontent.com/hawkthorne/hawkthorne-journey/master/src/character_map.json").then((function(t){return t.json()})).then((function(t){o.setState({characterMap:t},(function(){o.initializeMap()}))})),F.forEach((function(t){fetch("https://raw.githubusercontent.com/hawkthorne/hawkthorne-journey/master/src/characters/"+t+".json").then((function(t){return t.json()})).then((function(e){var n=Object.assign({},o.state.characters);n[t]=e,o.setState({characters:n})}))}))},o.handleResize=function(){var t=window.innerWidth,e=window.innerHeight;null!==o.state.drawingSystem&&o.state.drawingSystem.ConfigUpdate({height:e,width:t,board:document.getElementById("board")})},o.initializeMap=function(){var t=new I(B+"/src/maps/"+o.state.map+".tmx");setTimeout((function(){if(void 0!==t.properties.soundtrack){var e=t.properties.soundtrack,n="";n=-1!==e.search("ogg")?B+"/src/"+e:"https://raw.githubusercontent.com/hawkthorne/hawkthorne-journey/master/src/audio/music/"+t.properties.soundtrack+".ogg",o.setState({music:n}),document.getElementById("rap").play()}else document.getElementById("rap").pause(),o.setState({music:""});t.layers.forEach((function(e){o.buildLayer(e,t.tilesets[0])})),t.objectgroups.forEach((function(t){t.objects.forEach((function(t){o.buildObject(t)}))})),console.log(o.world)}),500)},o.initializePlayer=function(){var t=document.getElementById("board"),e=V+o.state.playerCharacter+"/"+o.state.playerCostume+".png",n=o.world.Entity("player");n.Component(new C(o.state.levelStart)),n.Component(new g({canvas:t,url:e,width:48,height:48,characterMap:o.state.characterMap,animation:o.state.animation,direction:o.state.direction}))},o.initializeCharacters=function(){var t=document.getElementById("board"),e=50,n=200;F.forEach((function(a){var i=V+a+"/base.png",r=o.world.Entity();r.Component(new C({x:e,y:n})),r.Component(new g({canvas:t,url:i,width:48,height:48,characterMap:o.state.characterMap,animation:o.state.animation,direction:o.state.direction})),(e+=50)>450&&(e=0,n+=50)}))},o.buildObject=function(t){if("sprite"!==t.type){if("door"===t.type){if("main"!=t.name)return;o.setState({levelStart:{x:t.x-0,y:t.y-0}},(function(){o.initializePlayer()}))}void 0===t.polygon||o.buildPolygon(t)}else o.buildSprite(t)},o.buildPolygon=function(t){var e=o.world.Entity();e.Component(new C({x:t.x,y:t.y})),e.Component(new j({points:t.polygon.points}))},o.buildSprite=function(t){var e=B+"/src/"+t.properties.sheet,n=o.world.Entity();n.Component(new C({x:t.x,y:t.y}));var a={flipHorizontal:"true"===t.properties.flip};n.Component(new v({canvas:document.getElementById("board"),url:e,width:t.properties.width,height:t.properties.height,x:t.x,y:t.y,options:a}))},o.buildLayer=function(t,e){var n=B+"/src/images/"+e.image.source,a=e.tilewidth,i=e.tileheight,r=e.image.width/a,s=o.world.Entity();s.Component(new y({url:n,width:a,height:i}));for(var c=t.width,l=t.height,h=0,p=0;p<l;p++)for(var d=0;d<c;d++){var u=t.tiles[h].id;if(-1!==u){var m=u%r,f=(u-m)/r,b={};!0===t.tiles[h].flipHorizontal&&(b.flipHorizontal=!0),!0===t.tiles[h].flipVertical&&(b.flipVertical=!0),!0===t.tiles[h].flipDiagonal&&(b.flipDiagonal=!0),(s=o.world.Entity()).Component(new C({x:d,y:p})),s.Component(new w({tilesheet:n,width:a,height:i,x:m,y:f,options:b})),h++}else h++}},o.changeAnimation=function(t){o.setState({animation:t.target.value},(function(){o.updateSpriteComponent()}))},o.changeDirection=function(t){o.setState({direction:t.target.value},(function(){o.updateSpriteComponent()}))},o.updateSpriteComponent=function(){Object.keys(o.world.Components.SpriteComponent).forEach((function(t){o.world.Components.SpriteComponent[t].animation=o.state.animation,o.world.Components.SpriteComponent[t].direction=o.state.direction}))},o.destroyMap=function(){Object.keys(o.world.Components.TileComponent).forEach((function(t){o.world.Entity(t).destroy()})),Object.keys(o.world.Components.StaticSpriteComponent).forEach((function(t){o.world.Entity(t).destroy()})),Object.keys(o.world.Components.PolygonComponent).forEach((function(t){o.world.Entity(t).destroy()}))},o.changeMap=function(t){o.destroyMap(),o.setState({map:t.target.value},(function(){o.initializeMap()}))},o.volume=function(t){o.setState({volume:t.target.volume})},o.state={music:"",volume:.25,map:"studyroom",animation:"idle",direction:"right",characterMap:{},characters:{},drawingSystem:new x({width:window.innerWidth,height:window.innerHeight}),levelStart:{x:0,y:0},playerCharacter:"annie",playerCostume:"santa"},o.world=U.Container(),o.world.System(o.state.drawingSystem),o.world.Start(250),o}return Object(c.a)(n,[{key:"render",value:function(){return Object(D.jsxs)("div",{children:[Object(D.jsx)("canvas",{id:"board",width:"1280",height:"720"}),Object(D.jsxs)("div",{style:{float:"right"},children:[Object(D.jsx)("label",{htmlFor:"map",children:"Choose map:"}),Object(D.jsx)("br",{}),Object(D.jsx)("select",{id:"map",defaultValue:this.state.map,onChange:this.changeMap,children:W.map((function(t,e){return Object(D.jsx)("option",{children:t},e)}))}),Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),Object(D.jsx)("label",{htmlFor:"animation",children:"Choose animation:"}),Object(D.jsx)("br",{}),Object(D.jsx)("select",{id:"animation",defaultValue:this.state.animation,onChange:this.changeAnimation,children:Object.keys(this.state.characterMap).map((function(t,e){return Object(D.jsx)("option",{children:t},e)}))}),Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),Object(D.jsx)("label",{htmlFor:"direction",children:"Choose direction:"}),Object(D.jsx)("br",{}),Object(D.jsxs)("select",{id:"direction",defaultValue:this.state.direction,onChange:this.changeDirection,children:[Object(D.jsx)("option",{value:"left",children:"Left"}),Object(D.jsx)("option",{value:"right",children:"Right"})]}),Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),Object(D.jsx)(d.a,{id:"rap",src:this.state.music,loop:!0,controls:!0,onVolumeChanged:this.volume,volume:this.state.volume})]})]})}}]),n}(o.Component),A=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(e){var n=e.getCLS,o=e.getFID,a=e.getFCP,i=e.getLCP,r=e.getTTFB;n(t),o(t),a(t),i(t),r(t)}))};r.a.render(Object(D.jsx)(a.a.StrictMode,{children:Object(D.jsx)(L,{})}),document.getElementById("root")),A()}},[[38,1,2]]]);
//# sourceMappingURL=main.ca2f1444.chunk.js.map